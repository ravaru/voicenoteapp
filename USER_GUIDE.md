# VoiceNote — руководство пользователя

VoiceNote — локальное macOS‑приложение для транскрибации MP3 и экспорта заметок в Obsidian.
Все данные обрабатываются на вашем компьютере.

## Быстрый старт

1) Запустите приложение.
2) Перетащите MP3 в область загрузки **или** нажмите «Добавить аудио».
3) Дождитесь статуса **Готово**.
4) Откройте запись и нажмите **«Экспорт в Obsidian»**.

## Экран «Записи»

- **Добавление**: drag&drop MP3 в область загрузки или кнопка «Добавить аудио».
- **Статусы**:
  - В очереди — файл ожидает обработки.
  - Обработка/Транскрибация/Суммаризация — идет работа.
  - Готово — можно экспортировать.
  - Ошибка/Отмена — обработка не завершена.
- **Действия**:
  - **Открыть** — доступно при «В работе» и «Готово».
  - **Экспорт** — доступно только при «Готово».
  - **Отмена** — значок отмены, если идет обработка.
  - **Удалить** — значок корзины, если обработка завершена или не началась.

## Экран «Детали»

Вверху — имя записи и вкладки:
- **Расшифровка** — список сегментов с таймкодами. Клик по сегменту запускает проигрывание фрагмента.
- **Сводка** — итоговый Markdown‑текст. Если саммари ещё не готово, показывается placeholder.
- **Консоль** — текущие логи обработки.

Статус **Готово** отображается рядом с вкладками.

### Поиск в расшифровке
Вкладка «Расшифровка» содержит поиск по тексту. Вводите фразу — список сегментов фильтруется.

### Плеер
Внизу вкладки «Расшифровка» находится плеер фрагмента: Play/Pause, время, прогресс‑бар.

## Экспорт в Obsidian

Кнопка **«Экспорт в Obsidian»** доступна только при статусе «Готово».
Экспорт создает **один Markdown‑файл** с расшифровкой и сводкой (если есть).

Если путь Obsidian не настроен — откройте настройки и укажите Vault.

## Настройки

Вкладки:
- **Общие**:
  - Путь к Vault Obsidian + кнопка «Обзор»
  - Подпапка вывода
  - Язык интерфейса
- **Расшифровка**:
  - Whisper‑модель
  - Язык распознавания
  - Метки времени
  - Предзагрузка модели
- **Суммаризация**:
  - Включить/авто‑суммаризацию
  - Модель Ollama
  - Промпт суммаризации (можно редактировать)

Статус **«Сохранено»** показывается справа от вкладок на 5 секунд.


## Pipeline обработки

1) **Добавление аудио**: файл MP3/M4A/WAV попадает в очередь и сохраняется как `audio.original.<ext>`.
2) **Конвертация**: `ffmpeg` -> `audio.wav` (16kHz, mono).
3) **Транскрибация**: whisper.cpp с выбранной моделью и языком.
4) **Артефакты**: создаются `whisper.txt`, `whisper.srt`, `whisper.json`.
5) **Суммаризация (опционально)**: локально через Ollama.
6) **Заметка**: `note.md` (Transcript + Summary).
7) **Экспорт**: по кнопке в выбранный Obsidian vault.

## Консоль

Показывает шаги обработки в реальном времени.
Если логи длинные, используйте кнопку «К последнему» для автоскролла.

## Поддерживаемые форматы

- **MP3, M4A, WAV**. Все форматы конвертируются в WAV 16kHz mono для распознавания.

## Частые вопросы

**Где лежат результаты?**  
`AppData/voicenote/jobs/<job_id>/` — все артефакты обработки (audio, whisper.txt/.srt/.json, summary.md, note.md).

**Почему саммари не создается?**  
Нужен запущенный Ollama по адресу, указанному в настройках.

## Горячие клавиши

- `Esc` — выход из деталей записи обратно в список.

---
Если нужен более подробный гайд или справка по установке — скажите, добавлю.
